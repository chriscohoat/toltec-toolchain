# vim: set ft=sh:

# Print an error message to error output then exit
#
# Arguments:
#
# $1 - Error message to print
error() {
    echo "Error: $1" >&2
    exit 1
}

# Print a status message
#
# Arguments:
#
# $1 - Current status message
status() {
    echo "=> $1" >&2
}

# Get the full tag of a Docker image
#
# Arguments:
#
# $1 - Name of the image
# $2 - Version of the image
image-name() {
    # This will typically be set to 'ghcr.io' for GitHub Container Registry
    # by the GitHub action. But to enable local builds, we set a default.
    local default_registry="ghcr.io"
    local registry="${REGISTRY:-$default_registry}"
    
    # Use IMAGE_NAME if it exists and split it to get the repo name,
    # otherwise, use the default repository name.
    local default_repo="toltec-dev"
    local repo="${default_repo}"
    if [ -n "${IMAGE_NAME}" ]; then
        repo=$(echo "${IMAGE_NAME}" | cut -d'/' -f2)
    fi

    echo "$registry/$repo/$1:${2:-latest}"
}
